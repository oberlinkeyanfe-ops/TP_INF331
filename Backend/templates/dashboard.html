{% extends "base.html" %}
{% block title %}Tableau de Bord{% endblock %}

{% block content %}
<div class="dashboard-container">
    <h2>Tableau de Bord Aviculture Pro</h2>
    <p class="welcome-message">Bienvenue, {{ session.get('eleveur_nom', '√âleveur') }} !</p>

    <div class="dashboard-grid">
        <!-- SECTION CHATBOT - CONDITIONNELLE -->
        {% if GEMINI_AVAILABLE %}
        <div class="dashboard-card chatbot-card">
            <h3>Chatbot Intelligent</h3>
            <p>Posez des questions sur vos donn√©es d'√©levage</p>
            <a href="{{ url_for('chatbot.chatbot_page') }}" class="btn btn-primary">Ouvrir le Chatbot</a>
        </div>
        {% else %}
        <div class="dashboard-card" style="background: #f8f9fa; color: #666;">
            <h3>Chatbot (Non disponible)</h3>
            <p>Installez Google Generative AI pour activer le chatbot intelligent</p>
            <a href="#" class="btn disabled">Non disponible</a>
        </div>
        {% endif %}

        <!-- SECTION GESTION -->
        <div class="dashboard-card gestion-card">
            <h3>Gestion des Donn√©es</h3>
            <div class="gestion-grid">
                <a href="{{ url_for('bandes.gestion_bandes') }}" class="gestion-item">
                    <span>üè∑Ô∏è Bandes</span>
                    <small>Cr√©er, modifier, supprimer des bandes</small>
                </a>
                <a href="{{ url_for('animaux.animaux_page') }}" class="gestion-item">
                    <span>üêî Animaux</span>
                    <small>G√©rer les animaux individuels</small>
                </a>
                <a href="{{ url_for('workers.workers_page') }}" class="gestion-item">
                    <span>üë• Employ√©s</span>
                    <small>Personnel & v√©t√©rinaires</small>
                </a>
                <a href="{{ url_for('traitements.traitements_page') }}" class="gestion-item">
                    <span>üíä Traitements</span>
                    <small>Sant√© et m√©dicaments</small>
                </a>
                <a href="{{ url_for('consommations.consommations_page') }}" class="gestion-item">
                    <span>üçó Consommations</span>
                    <small>Aliment & eau</small>
                </a>
                <a href="{{ url_for('depenses.depenses_page') }}" class="gestion-item">
                    <span>üí∞ D√©penses</span>
                    <small>Co√ªts et budgets</small>
                </a>
                <a href="{{ url_for('interventions.interventions_page') }}" class="gestion-item">
                    <span>üîß Interventions</span>
                    <small>Activit√©s du personnel</small>
                </a>
            </div>
        </div>

        <!-- SECTION PR√âDICTIONS -->
        <div class="dashboard-card predictions-card">
            <h3>Pr√©dictions & Statistiques</h3>
            <p>Analyses et visualisations de vos donn√©es</p>
            <a href="{{ url_for('predictions.predictions_page') }}" class="btn btn-secondary">Voir les Statistiques</a>
        </div>
    </div>

    <!-- STATISTIQUES RAPIDES -->
    <div class="stats-container">
        <h3>Aper√ßu Rapide</h3>
        <div class="stats-grid">
            <div class="stat-item">
                <span class="stat-number">{{ bandes_count }}</span>
                <span class="stat-label">Bandes Actives</span>
            </div>
            <div class="stat-item">
                <span class="stat-number">{{ animaux_count }}</span>
                <span class="stat-label">Animaux</span>
            </div>
            <div class="stat-item">
                <span class="stat-number">{{ depenses_total }} FCFA</span>
                <span class="stat-label">D√©penses Total</span>
            </div>
            <div class="stat-item">
                <span class="stat-number">{{ traitements_count }}</span>
                <span class="stat-label">Traitements</span>
            </div>

            <!-- NOUVELLES STATISTIQUES -->
            <div class="stat-item">
                <span class="stat-number">{{ nb_nouveaux_nes }}</span>
                <span class="stat-label">Nouveaux n√©s</span>
            </div>
            <div class="stat-item">
                <span class="stat-number">{{ nb_morts }}</span>
                <span class="stat-label">Morts</span>
            </div>
            <div class="stat-item">
                <span class="stat-number">{{ nb_maladies_rencontrees }}</span>
                <span class="stat-label">Maladies rencontr√©es</span>
            </div>
            <div class="stat-item">
                <span class="stat-number">{{ nb_malades }}</span>
                <span class="stat-label">Nombre de malades</span>
            </div>
            <div class="stat-item">
                <span class="stat-number">{{ nb_epidemies }}</span>
                <span class="stat-label">√âpid√©mies</span>
            </div>
        </div>
    </div>
</div>

<style>
.dashboard-grid {
    display: grid;
    grid-template-columns: 1fr 2fr 1fr;
    gap: 20px;
    margin-bottom: 30px;
}

.dashboard-card {
    background: rgb(224, 4, 4);
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

.chatbot-card {
    background: linear-gradient(135deg, #023606 0%, #194405 100%);
    color: white;
}

.gestion-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px;
}

.gestion-item {
    display: block;
    padding: 15px;
    background: #79e7cf;
    border-radius: 8px;
    text-decoration: none;
    color: #333;
    transition: all 0.3s;
}

.gestion-item:hover {
    background: #03630b;
    color: white;
    transform: translateY(-2px);
}

.predictions-card {
    background: linear-gradient(135deg, #e0b909 0%, #ecd60b 100%);
    color: white;
}

.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
    gap: 15px;
    margin-top: 15px;
}

.stat-item {
    text-align: center;
    padding: 15px;
    background: white;
    border-radius: 8px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}

.stat-number {
    display: block;
    font-size: 24px;
    font-weight: bold;
    color: #007bff;
}

.stat-label {
    font-size: 14px;
    color: #666;
}

.btn {
    display: inline-block;
    padding: 10px 20px;
    background: #007bff;
    color: white;
    text-decoration: none;
    border-radius: 5px;
    margin-top: 10px;
}

.btn-primary { background: #007bff; }
.btn-secondary { background: #6c757d; }
.btn.disabled {
    background: #6c757d;
    cursor: not-allowed;
    opacity: 0.6;
}
</style>
{% endblock %}
